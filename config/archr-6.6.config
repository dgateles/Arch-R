# Arch R Kernel 6.6 LTS Configuration Fragment
# 
# Apply on top of defconfig with:
#   make ARCH=arm64 defconfig
#   scripts/kconfig/merge_config.sh .config archr.config
#
# Target: RK3326 (R36S handheld) with Panfrost GPU

# =============================================================================
# PLATFORM - ROCKCHIP RK3326
# =============================================================================
CONFIG_ARCH_ROCKCHIP=y
CONFIG_ROCKCHIP_PM_DOMAINS=y
CONFIG_ROCKCHIP_IOMMU=y

# =============================================================================
# CPU PERFORMANCE
# =============================================================================
CONFIG_ARM64=y
CONFIG_SMP=y
CONFIG_NR_CPUS=4
CONFIG_PREEMPT=y
CONFIG_HZ_1000=y
CONFIG_HZ=1000

# CPU Frequency Scaling
CONFIG_CPU_FREQ=y
CONFIG_CPU_FREQ_DEFAULT_GOV_PERFORMANCE=y
CONFIG_CPU_FREQ_GOV_PERFORMANCE=y
CONFIG_CPU_FREQ_GOV_POWERSAVE=y
CONFIG_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y
CONFIG_CPUFREQ_DT=y

# =============================================================================
# GPU - PANFROST (Mali-G31)
# =============================================================================
CONFIG_DRM=y
CONFIG_DRM_PANFROST=y
CONFIG_DRM_ROCKCHIP=y
CONFIG_DRM_PANEL_SIMPLE=y
CONFIG_DRM_MIPI_DSI=y

# GPU memory management
CONFIG_DRM_GEM_SHMEM_HELPER=y

# =============================================================================
# DISPLAY
# =============================================================================
CONFIG_FB=y
CONFIG_FB_SIMPLE=y
CONFIG_FRAMEBUFFER_CONSOLE=y
CONFIG_BACKLIGHT_CLASS_DEVICE=y
CONFIG_BACKLIGHT_PWM=y

# DSI panel support
CONFIG_DRM_PANEL=y
CONFIG_DRM_PANEL_SITRONIX_ST7703=y
CONFIG_DRM_PANEL_ELIDA_KD35T133=y

# =============================================================================
# WIFI DRIVERS (Comprehensive USB WiFi Support)
# =============================================================================
CONFIG_WIRELESS=y
CONFIG_CFG80211=m
CONFIG_MAC80211=m
CONFIG_MAC80211_LEDS=y
CONFIG_WLAN=y

# --- Realtek ---
CONFIG_RTW88=m
CONFIG_RTW88_8822BE=m
CONFIG_RTW88_8822CE=m
CONFIG_RTW88_8723DE=m
CONFIG_RTW88_8821CE=m
CONFIG_RTW88_USB=m

CONFIG_RTW89=m
CONFIG_RTW89_8852AE=m
CONFIG_RTW89_8852BE=m
CONFIG_RTW89_USB=m

CONFIG_RTL8XXXU=m
CONFIG_RTL8XXXU_UNTESTED=y

# Legacy Realtek
CONFIG_RTL8187=m
CONFIG_RTL8192CU=m

# --- Intel ---
CONFIG_IWLWIFI=m
CONFIG_IWLMVM=m
CONFIG_IWLDVM=m

# --- MediaTek ---
CONFIG_MT76_USB=m
CONFIG_MT76x0U=m
CONFIG_MT76x2U=m
CONFIG_MT7601U=m
CONFIG_MT7921U=m
CONFIG_MT7925U=m

# --- Atheros ---
CONFIG_ATH_COMMON=m
CONFIG_ATH9K=m
CONFIG_ATH9K_HTC=m
CONFIG_ATH10K=m
CONFIG_ATH10K_USB=m

# --- Ralink ---
CONFIG_RT2X00=m
CONFIG_RT2800USB=m
CONFIG_RT2800USB_RT33XX=y
CONFIG_RT2800USB_RT35XX=y
CONFIG_RT2800USB_RT3573=y
CONFIG_RT2800USB_RT53XX=y
CONFIG_RT2800USB_RT55XX=y
CONFIG_RT2800USB_UNKNOWN=y

# --- Broadcom ---
CONFIG_BRCMFMAC=m
CONFIG_BRCMFMAC_USB=y

# --- Marvell ---
CONFIG_MWIFIEX=m
CONFIG_MWIFIEX_USB=m

# =============================================================================
# USB
# =============================================================================
CONFIG_USB_SUPPORT=y
CONFIG_USB=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_EHCI_HCD=y
CONFIG_USB_OHCI_HCD=y
CONFIG_USB_DWC2=y
CONFIG_USB_DWC2_HOST=y
CONFIG_USB_DWC2_DUAL_ROLE=y
CONFIG_USB_STORAGE=m
CONFIG_USB_SERIAL=m
CONFIG_USB_SERIAL_OPTION=m

# USB Modeswitch (for WiFi dongles)
CONFIG_USB_ACM=m
CONFIG_USB_WDM=m

# =============================================================================
# INPUT (Gamepad)
# =============================================================================
CONFIG_INPUT=y
CONFIG_INPUT_JOYDEV=y
CONFIG_INPUT_EVDEV=y
CONFIG_INPUT_FF_MEMLESS=y
CONFIG_JOYSTICK_XPAD=m
CONFIG_JOYSTICK_ADC=m

# PWM for rumble
CONFIG_PWM=y
CONFIG_PWM_ROCKCHIP=y

# =============================================================================
# AUDIO
# =============================================================================
CONFIG_SOUND=y
CONFIG_SND=y
CONFIG_SND_SOC=y
CONFIG_SND_SOC_ROCKCHIP=y
CONFIG_SND_SOC_ROCKCHIP_I2S=y
CONFIG_SND_SOC_RK817=y
CONFIG_SND_USB_AUDIO=m

# =============================================================================
# POWER MANAGEMENT
# =============================================================================
CONFIG_REGULATOR=y
CONFIG_REGULATOR_RK808=y
CONFIG_MFD_RK8XX_I2C=y
CONFIG_MFD_RK808=y
CONFIG_CHARGER_RK817=y
CONFIG_BATTERY_RK817=y

# =============================================================================
# FILESYSTEM
# =============================================================================
CONFIG_EXT4_FS=y
CONFIG_BTRFS_FS=y
CONFIG_VFAT_FS=y
CONFIG_EXFAT_FS=m
CONFIG_NTFS3_FS=m
CONFIG_SQUASHFS=y
CONFIG_SQUASHFS_LZ4=y

# =============================================================================
# COMPRESSION (for ZRAM)
# =============================================================================
CONFIG_ZRAM=m
CONFIG_ZSWAP=y
CONFIG_LZ4_COMPRESS=y
CONFIG_LZ4_DECOMPRESS=y
CONFIG_ZSTD_COMPRESS=y
CONFIG_ZSTD_DECOMPRESS=y

# =============================================================================
# NETWORK
# =============================================================================
CONFIG_NET=y
CONFIG_INET=y
CONFIG_IPV6=y
CONFIG_NETFILTER=y
CONFIG_NF_CONNTRACK=m
CONFIG_NETFILTER_XT_MATCH_CONNTRACK=m
CONFIG_IP_NF_IPTABLES=m
CONFIG_IP_NF_FILTER=m
CONFIG_IP_NF_NAT=m

# Bluetooth
CONFIG_BT=m
CONFIG_BT_RFCOMM=m
CONFIG_BT_BNEP=m
CONFIG_BT_HIDP=m
CONFIG_BT_HCIBTUSB=m
CONFIG_BT_HCIUART=m

# =============================================================================
# GPIO/LED
# =============================================================================
CONFIG_GPIOLIB=y
CONFIG_GPIO_ROCKCHIP=y
CONFIG_LEDS_GPIO=y
CONFIG_LEDS_TRIGGER_HEARTBEAT=y
CONFIG_LEDS_TRIGGER_DEFAULT_ON=y

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
# Disable debugging for release builds
# CONFIG_DEBUG_INFO is not set
# CONFIG_DEBUG_FS is not set
# CONFIG_FTRACE is not set
# CONFIG_KPROBES is not set

# Enable performance features
CONFIG_JUMP_LABEL=y
CONFIG_TRANSPARENT_HUGEPAGE=y
